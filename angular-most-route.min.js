function HttpRoute(url,route){this.routeData=[],this.url=url,this.route=route}function getRouteParams(url){if(null==url)return[];if(0==url.length)return[];for(var re=/(:\b(\w+)\b)/gi,result=[],arr=[];null!==(arr=re.exec(url));)result.push(arr[0]);return result}HttpRoute.prototype.data=function(key){try{if(null==key)return null;if(0==key.length)return null;for(var item=null,i=0;i<this.routeData.length;i++){var x=this.routeData[i];if(x.name==(0==key.indexOf(":")?key:":"+key)){item=x;break}}return null!=item?item.value:null}catch(e){throw e}},HttpRoute.prototype.parse=function(url){var result=[];if(null==url||null==this.url)return result;if(0==url.length||0==this.url.length)return result;var params=getRouteParams(this.url),str=this.url.replace(/(:\b(\w+)\b)/gi,"([\\w-]+)"),matcher=new RegExp("^"+str+"$"),matches=matcher.exec(url);this.routeData=[];for(var i=0;i<params.length;i++)this.routeData.push({name:params[i],value:matches[i+1]})},HttpRoute.prototype.format=function(){if(null==this.route)throw"Route cannot be empty.";for(var path=this.route,i=0;i<this.routeData.length;i++){var item=this.routeData[i];path=path.replace(item.name,item.value)}return path},HttpRoute.prototype.isMatch=function(url){if(null==url||null==this.url)return!1;if(0==url.length||0==this.url.length)return!1;var url1=url,k=url.indexOf("?");k>=0&&(url1=url.substr(0,k));var str=this.url.replace(/(:\b(\w+)\b)/gi,"([\\w-]+)"),matcher=new RegExp("^"+str+"$");return matcher.test(url1)},HttpRoute.query=function(url){var result={};if("string"!=typeof url)return result;if("undefined"==typeof window)return result;if("undefined"==typeof window.routes)return result;var uri=url,r=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/gi,matches=r.exec(url);matches&&(uri=matches[3]);for(var routes=window.routes,httpRoute=null,i=0;i<routes.length;i++){var item=routes[i];if(httpRoute=route.createInstance(item.url,item.route),httpRoute.isMatch(uri)){httpRoute.parse(uri);var param=httpRoute.routeData.filter(function(x){return":controller"==x.name})[0];if("undefined"==typeof param){var controller=item.controller;if("undefined"==typeof controller){var segments=uri.split("/");controller=2==segments.length?"root":segments[1]}httpRoute.routeData.push({name:":controller",value:controller})}param=httpRoute.routeData.filter(function(x){return":action"==x.name})[0],"undefined"==typeof param&&httpRoute.routeData.push({name:":action",value:item.action});break}}for(var i=0;i<httpRoute.routeData.length;i++){var item=httpRoute.routeData[i],name=item.name.substr(1);result[name]=item.value}var querystring=matches[4];if(querystring)for(var query=querystring.split("&"),i=0;i<query.length;i++){var queryParam=query[i].split("=");2==queryParam.length&&"undefined"==typeof result[queryParam[0]]&&(result[queryParam[0]]=queryParam[1])}return result};var route={createInstance:function(url,route){return new HttpRoute(url,route)},query:HttpRoute.query};"undefined"!=typeof window&&(window.route=route.query(window.location.href)),"undefined"!=typeof exports&&(module.exports=route);